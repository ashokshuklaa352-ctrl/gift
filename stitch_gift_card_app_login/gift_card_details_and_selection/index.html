<!DOCTYPE html>

<html class="light" lang="en">

<head>
    <meta charset="utf-8" />
    <meta content="width=device-width, initial-scale=1.0" name="viewport" />
    <script src="https://cdn.tailwindcss.com?plugins=forms,container-queries"></script>
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <script src="../supabase_client.js"></script>
    <script>
        async function checkAuth() {
            if (!window.supabaseClient) return;
            const { data: { session } } = await window.supabaseClient.auth.getSession();
            if (!session) {
                window.location.href = '../gift_card_app_login/index.html';
            }
        }
        window.addEventListener('load', checkAuth);
    </script>
    <link
        href="https://fonts.googleapis.com/css2?family=Epilogue:wght@400;500;600;700;800&amp;family=Manrope:wght@400;500;600&amp;display=swap"
        rel="stylesheet" />
    <link
        href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:wght,FILL@100..700,0..1&amp;display=swap"
        rel="stylesheet" />
    <link
        href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:wght,FILL@100..700,0..1&amp;display=swap"
        rel="stylesheet" />
    <script id="tailwind-config">
        tailwind.config = {
            darkMode: "class",
            theme: {
                extend: {
                    colors: {
                        "primary": "#5d40d4",
                        "accent": "#9ADE7B",
                        "background-light": "#faf7f4",
                        "background-dark": "#1a1a1a",
                    },
                    fontFamily: {
                        "display": ["Epilogue", "sans-serif"],
                        "body": ["Manrope", "sans-serif"]
                    },
                    borderRadius: {
                        "DEFAULT": "0.5rem",
                        "lg": "1rem",
                        "xl": "1.5rem",
                        "full": "9999px"
                    },
                },
            },
        }
    </script>
    <style>
        body {
            font-family: 'Manrope', sans-serif;
        }

        .font-display {
            font-family: 'Epilogue', sans-serif;
        }

        .custom-shadow {
            box-shadow: 0 4px 20px -2px rgba(93, 64, 212, 0.15);
        }

        .glass {
            background: rgba(255, 255, 255, 0.8);
            backdrop-filter: blur(8px);
        }

        .dark .glass {
            background: rgba(26, 26, 26, 0.8);
            backdrop-filter: blur(8px);
        }
    </style>
    <style>
        body {
            min-height: max(884px, 100dvh);
        }
    </style>
</head>

<body class="bg-background-light dark:bg-background-dark text-[#110f1a] dark:text-white min-h-screen pb-32">
    <!-- Top Navigation Bar -->
    <div class="sticky top-0 z-50 glass border-b border-gray-200 dark:border-gray-800">
        <div class="flex items-center p-4 justify-between max-w-md mx-auto">
            <div class="flex size-10 shrink-0 items-center justify-center rounded-full hover:bg-gray-100 dark:hover:bg-gray-800 cursor-pointer"
                onclick="window.location.href='../browse_trending_deals/index.html'">
                <span class="material-symbols-outlined text-2xl">arrow_back</span>
            </div>
            <h2 class="font-display text-lg font-bold leading-tight tracking-tight flex-1 text-center">Gift Card Details
            </h2>
            <div
                class="flex size-10 items-center justify-center rounded-full hover:bg-gray-100 dark:hover:bg-gray-800 cursor-pointer">
                <span class="material-symbols-outlined text-2xl">share</span>
            </div>
        </div>
    </div>
    <main class="max-w-md mx-auto">
        <!-- Brand Header Section -->
        <div id="product-header" class="px-4 pt-4">
            <div id="brand-banner" class="relative h-64 w-full overflow-hidden rounded-xl bg-primary flex items-end"
                style='background-image: linear-gradient(180deg, rgba(0, 0, 0, 0) 40%, rgba(93, 64, 212, 0.9) 100%), url("https://lh3.googleusercontent.com/aida-public/AB6AXuAoEsdmY3HkO6QHNyQgyF2G66vlR95YA6awlN6-imhGZobZZQHHa4sQxqA2qfOYKw9omFRSwPM1MuRiux-89bzcr4VBVnzt-Qffn8YBhOgDf9oRRHn7FsSwjqZwBBH_883F7YM96Gj0KsyAkzgjF5qy-Je8CiMq-XO9-HQkgigE1643JCxc-H_kiRVW11es1fQvYLDpMWBQY_pRyLIkvJN9xTes3MyfltXLHu8gfoEpv0N0nbuGuiTX8HPaWmCxkMK8Ikj90prwCdTZ"); background-size: cover; background-position: center;'>
                <div class="p-6 w-full flex justify-between items-end">
                    <div>
                        <div class="flex items-center gap-2 mb-1">
                            <span
                                class="bg-accent text-primary text-[10px] font-bold px-2 py-0.5 rounded-full uppercase tracking-wider">Verified</span>
                        </div>
                        <h1 id="brand-name" class="text-white font-display text-3xl font-extrabold tracking-tight">
                            Netflix</h1>
                        <p id="brand-type" class="text-white/80 text-sm">Streaming Subscription</p>
                    </div>
                    <div class="bg-white/20 backdrop-blur-md p-2 rounded-lg border border-white/30">
                        <span id="brand-icon" class="material-symbols-outlined text-white text-3xl">movie</span>
                    </div>
                </div>
            </div>
        </div>
        <!-- Purchase Type Toggle -->
        <div class="px-4 mt-8">
            <div class="bg-gray-200/50 dark:bg-gray-800 p-1 rounded-xl flex">
                <button
                    class="flex-1 bg-white dark:bg-gray-700 py-2.5 rounded-lg text-sm font-bold shadow-sm flex items-center justify-center gap-2">
                    <span class="material-symbols-outlined text-sm">person</span>
                    Buy for myself
                </button>
                <button id="send-as-gift-btn" onclick="goToPersonalize()"
                    class="flex-1 py-2.5 rounded-lg text-sm font-bold text-gray-500 dark:text-gray-400 flex items-center justify-center gap-2">
                    <span class="material-symbols-outlined text-sm">redeem</span>
                    Send as gift
                </button>
            </div>
        </div>
        <!-- Section: Select Amount -->
        <div class="mt-8">
            <div class="flex items-center justify-between px-4 mb-4">
                <h3 class="font-display text-xl font-bold tracking-tight">Select Amount</h3>
                <span class="text-xs font-bold text-primary bg-primary/10 px-2 py-1 rounded">5% Cashback</span>
            </div>
            <div class="grid grid-cols-2 gap-3 px-4">
                <!-- Amount 25 -->
                <div id="amt-25" onclick="selectAmount(25)"
                    class="relative flex flex-col gap-1 rounded-xl border-2 border-primary bg-white dark:bg-gray-800 p-5 cursor-pointer transition-all hover:scale-[1.02] shadow-md">
                    <div id="check-25" class="absolute top-2 right-2 text-primary">
                        <span class="material-symbols-outlined text-xl">check_circle</span>
                    </div>
                    <p class="text-xs font-semibold text-gray-400 uppercase tracking-widest">INR</p>
                    <h2 class="font-display text-3xl font-extrabold text-primary">₹25</h2>
                </div>
                <!-- Amount 50 -->
                <div id="amt-50" onclick="selectAmount(50)"
                    class="relative flex flex-col gap-1 rounded-xl border border-gray-200 dark:border-gray-700 bg-white dark:bg-gray-800 p-5 cursor-pointer transition-all hover:border-primary/50">
                    <div id="check-50" class="hidden absolute top-2 right-2 text-primary">
                        <span class="material-symbols-outlined text-xl">check_circle</span>
                    </div>
                    <p class="text-xs font-semibold text-gray-400 uppercase tracking-widest">INR</p>
                    <h2 class="font-display text-3xl font-extrabold">₹50</h2>
                </div>
                <!-- Amount 100 -->
                <div id="amt-100" onclick="selectAmount(100)"
                    class="relative flex flex-col gap-1 rounded-xl border border-gray-200 dark:border-gray-700 bg-white dark:bg-gray-800 p-5 cursor-pointer transition-all hover:border-primary/50 overflow-hidden">
                    <div id="check-100" class="hidden absolute top-2 right-2 text-primary">
                        <span class="material-symbols-outlined text-xl">check_circle</span>
                    </div>
                    <div
                        class="absolute -right-6 top-3 bg-accent text-primary text-[8px] font-bold px-8 py-0.5 rotate-45">
                        BEST</div>
                    <p class="text-xs font-semibold text-gray-400 uppercase tracking-widest">INR</p>
                    <h2 class="font-display text-3xl font-extrabold">₹100</h2>
                </div>
                <!-- Custom -->
                <div
                    class="flex flex-col justify-center items-center gap-1 rounded-xl border border-dashed border-gray-300 dark:border-gray-600 bg-white/50 dark:bg-gray-800/50 p-5 cursor-pointer">
                    <span class="material-symbols-outlined text-gray-400">edit</span>
                    <p class="text-sm font-bold text-gray-500">Custom</p>
                </div>
            </div>
        </div>
        <!-- Description Section -->
        <div class="mt-8 px-4">
            <h3 class="font-display text-xl font-bold tracking-tight mb-3">About this card</h3>
            <div class="bg-white dark:bg-gray-800 p-5 rounded-xl border border-gray-100 dark:border-gray-800">
                <p class="text-sm text-gray-600 dark:text-gray-400 leading-relaxed">
                    Use a Netflix gift card to watch your favorite TV shows and movies on any device. It’s the perfect
                    way to pay for your subscription or give the gift of entertainment. No credit card required.
                </p>
                <div class="mt-4 flex flex-col gap-3">
                    <div class="flex items-center gap-3 text-xs font-medium text-gray-500">
                        <span class="material-symbols-outlined text-lg text-primary">bolt</span>
                        Instant digital delivery
                    </div>
                    <div class="flex items-center gap-3 text-xs font-medium text-gray-500">
                        <span class="material-symbols-outlined text-lg text-primary">lock</span>
                        Secure checkout &amp; encrypted payment
                    </div>
                </div>
                <button class="mt-4 text-primary text-sm font-bold flex items-center gap-1">
                    View full Terms &amp; Conditions
                    <span class="material-symbols-outlined text-sm">keyboard_arrow_right</span>
                </button>
            </div>
        </div>
        <!-- Extra spacing for footer -->
        <div class="h-10"></div>
    </main>
    <!-- Floating Bottom Action Bar -->
    <div class="fixed bottom-0 inset-x-0 glass border-t border-gray-200 dark:border-gray-800 p-4 pb-8 z-50">
        <div class="max-w-md mx-auto flex items-center justify-between gap-6">
            <div class="flex flex-col">
                <span class="text-xs font-bold text-gray-400 uppercase tracking-widest">Total Price</span>
                <div class="flex items-baseline gap-1">
                    <span id="total-price" class="font-display text-2xl font-extrabold text-primary">₹25.00</span>
                </div>
            </div>
            <button onclick="addToCart()"
                class="flex-1 bg-primary text-white font-display font-bold py-4 px-8 rounded-xl flex items-center justify-center gap-2 custom-shadow active:scale-95 transition-transform">
                <span class="material-symbols-outlined">shopping_cart</span>
                Add to Cart
            </button>
        </div>
    </div>
    <script>
        const params = new URLSearchParams(window.location.search);
        let brandName = params.get('name') || 'Netflix';
        let initialPrice = parseFloat(params.get('price')) || 25;
        let brandImage = params.get('image') || 'https://lh3.googleusercontent.com/aida-public/AB6AXuAoEsdmY3HkO6QHNyQgyF2G66vlR95YA6awlN6-imhGZobZZQHHa4sQxqA2qfOYKw9omFRSwPM1MuRiux-89bzcr4VBVnzt-Qffn8YBhOgDf9oRRHn7FsSwjqZwBBH_883F7YM96Gj0KsyAkzgjF5qy-Je8CiMq-XO9-HQkgigE1643JCxc-H_kiRVW11es1fQvYLDpMWBQY_pRyLIkvJN9xTes3MyfltXLHu8gfoEpv0N0nbuGuiTX8HPaWmCxkMK8Ikj90prwCdTZ';

        let selectedAmount = initialPrice;

        function loadProduct() {
            document.getElementById('brand-name').innerText = brandName;
            document.getElementById('brand-banner').style.backgroundImage = `linear-gradient(180deg, rgba(0, 0, 0, 0) 40%, rgba(93, 64, 212, 0.9) 100%), url("${brandImage}")`;

            // Adjust categories/icons based on name
            const iconMap = {
                'Netflix': 'movie',
                'Apple': 'apple',
                'Amazon': 'shopping_cart',
                'Spotify': 'music_note'
            };
            const typeMap = {
                'Netflix': 'Streaming Subscription',
                'Apple': 'Digital Content & Apps',
                'Amazon': 'Online Marketplace',
                'Spotify': 'Music Streaming'
            };

            if (iconMap[brandName]) document.getElementById('brand-icon').innerText = iconMap[brandName];
            if (typeMap[brandName]) document.getElementById('brand-type').innerText = typeMap[brandName];

            selectAmount(initialPrice);
        }

        function selectAmount(amount) {
            selectedAmount = amount;
            document.getElementById('total-price').innerText = '₹' + amount.toFixed(2);

            [25, 50, 100, 150].forEach(a => {
                const el = document.getElementById('amt-' + a);
                const check = document.getElementById('check-' + a);
                if (el) {
                    el.classList.remove('border-2', 'border-primary', 'shadow-md');
                    el.classList.add('border', 'border-gray-200');
                    if (check) check.classList.add('hidden');
                }
            });

            const selected = document.getElementById('amt-' + Math.round(amount));
            if (selected) {
                const check = document.getElementById('check-' + Math.round(amount));
                selected.classList.remove('border', 'border-gray-200');
                selected.classList.add('border-2', 'border-primary', 'shadow-md');
                if (check) check.classList.remove('hidden');
            }
        }

        function addToCart() {
            let cart = JSON.parse(localStorage.getItem('cart') || '[]');
            cart.push({ name: `${brandName} Gift Card`, price: selectedAmount, image: brandImage });
            localStorage.setItem('cart', JSON.stringify(cart));
            window.location.href = '../secure_checkout_summary/index.html';
        }

        function goToPersonalize() {
            const personalizeParams = new URLSearchParams({
                name: brandName,
                price: selectedAmount,
                image: brandImage
            });
            window.location.href = `../send_gift_with_message/index.html?${personalizeParams.toString()}`;
        }

        window.addEventListener('load', loadProduct);
    </script>
</body>

</html>